import XCTest
@testable import WebAuthn

// swiftlint:disable line_length

final class CertificateChainTests: XCTestCase {
    let validCert = "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUNWakNDQWI4Q0FnMzdNQTBHQ1NxR1NJYjNEUUVCQlFVQU1JR2JNUXN3Q1FZRFZRUUdFd0pLVURFT01Bd0cKQTFVRUNCTUZWRzlyZVc4eEVEQU9CZ05WQkFjVEIwTm9kVzh0YTNVeEVUQVBCZ05WQkFvVENFWnlZVzVyTkVSRQpNUmd3RmdZRFZRUUxFdzlYWldKRFpYSjBJRk4xY0hCdmNuUXhHREFXQmdOVkJBTVREMFp5WVc1ck5FUkVJRmRsCllpQkRRVEVqTUNFR0NTcUdTSWIzRFFFSkFSWVVjM1Z3Y0c5eWRFQm1jbUZ1YXpSa1pDNWpiMjB3SGhjTk1USXcKT0RJeU1EVXlOekl6V2hjTk1UY3dPREl4TURVeU56SXpXakJLTVFzd0NRWURWUVFHRXdKS1VERU9NQXdHQTFVRQpDQXdGVkc5cmVXOHhFVEFQQmdOVkJBb01DRVp5WVc1ck5FUkVNUmd3RmdZRFZRUUREQTkzZDNjdVpYaGhiWEJzClpTNWpiMjB3Z1o4d0RRWUpLb1pJaHZjTkFRRUJCUUFEZ1kwQU1JR0pBb0dCQU1ZQkJyeDVQbFAwV05JL1pkekQKKzZQa3RtdXJuK0Yya1FZYnRjN1hRaDgvTFRCdkNvK1A2aVpvTEVtVUE5ZTdFWExSeGdVMUNWcWVBaTdRY0FuOQpNd0JsYzhrc0ZKSEIwcnRmOXBtZjhPemE5RTBCeW5scS80L0tiMXgrZCtBeWhMN29LOXRRd0IyNHVIT3VlSGkxCkMvaVZ2OENTV0tpWWU2aHpOMXR4WWU4ckFnTUJBQUV3RFFZSktvWklodmNOQVFFRkJRQURnWUVBQVNQZGppZ0oKa1hDcUtXcG5aL09jNzVFVWNNaTZIenRhVzhhYlVNbFlYUElna1YyRjdZYW5IT0I3SzRmN09PTGppejhEVFBGZgpqQzlVZXVFcmhhQS96eldpOGV3TVRGWlcvV3NoT3JtM2ZOdmNNck1MS3RINTM0Skt2Y2RNZzZxSWRqVEZJTklyCmV2bkFoZjBjd1VMYWVibitsTXM4UGRsN3kzNytzZmx1Vm9rPQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0t"
    let validRootCert = "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUR2RENDQXlXZ0F3SUJBZ0lKQU1iSEJBbThJbHVnTUEwR0NTcUdTSWIzRFFFQkJRVUFNSUdiTVFzd0NRWUQKVlFRR0V3SktVREVPTUF3R0ExVUVDQk1GVkc5cmVXOHhFREFPQmdOVkJBY1RCME5vZFc4dGEzVXhFVEFQQmdOVgpCQW9UQ0VaeVlXNXJORVJFTVJnd0ZnWURWUVFMRXc5WFpXSkRaWEowSUZOMWNIQnZjblF4R0RBV0JnTlZCQU1UCkQwWnlZVzVyTkVSRUlGZGxZaUJEUVRFak1DRUdDU3FHU0liM0RRRUpBUllVYzNWd2NHOXlkRUJtY21GdWF6UmsKWkM1amIyMHdIaGNOTURjeE1qQTNNVEF5TVRRMldoY05NVGN4TWpBME1UQXlNVFEyV2pDQm16RUxNQWtHQTFVRQpCaE1DU2xBeERqQU1CZ05WQkFnVEJWUnZhM2x2TVJBd0RnWURWUVFIRXdkRGFIVnZMV3QxTVJFd0R3WURWUVFLCkV3aEdjbUZ1YXpSRVJERVlNQllHQTFVRUN4TVBWMlZpUTJWeWRDQlRkWEJ3YjNKME1SZ3dGZ1lEVlFRREV3OUcKY21GdWF6UkVSQ0JYWldJZ1EwRXhJekFoQmdrcWhraUc5dzBCQ1FFV0ZITjFjSEJ2Y25SQVpuSmhibXMwWkdRdQpZMjl0TUlHZk1BMEdDU3FHU0liM0RRRUJBUVVBQTRHTkFEQ0JpUUtCZ1FDN3I3eVBKZFhtREwyLytMMmlvZ3hRCnJMTUwrMTBFd0FZOWxKUkNIR1BxU0o4aWY3dGVxblhnRnI2TUFFaUN3VGNMdms0aDFVeExyRFhteG9vZWdOZzEKengvT09EYmNjKytTZkZDR21mbHdqL3dqTHBZUndQZ3V4Ny9RSWdyVXF6c2oySHRkUkZkK1dQVkQ0QU90WTlnbgp4ak5YRnBWZTF6bWdBbS9VRkxkTWV3SURBUUFCbzRJQkJEQ0NBUUF3SFFZRFZSME9CQllFRkdMemUrMEcxTEhWCm5IOUk1ZS9GeVJWaC9ka1JNSUhRQmdOVkhTTUVnY2d3Z2NXQUZHTHplKzBHMUxIVm5IOUk1ZS9GeVJWaC9ka1IKb1lHaHBJR2VNSUdiTVFzd0NRWURWUVFHRXdKS1VERU9NQXdHQTFVRUNCTUZWRzlyZVc4eEVEQU9CZ05WQkFjVApCME5vZFc4dGEzVXhFVEFQQmdOVkJBb1RDRVp5WVc1ck5FUkVNUmd3RmdZRFZRUUxFdzlYWldKRFpYSjBJRk4xCmNIQnZjblF4R0RBV0JnTlZCQU1URDBaeVlXNXJORVJFSUZkbFlpQkRRVEVqTUNFR0NTcUdTSWIzRFFFSkFSWVUKYzNWd2NHOXlkRUJtY21GdWF6UmtaQzVqYjIyQ0NRREd4d1FKdkNKYm9EQU1CZ05WSFJNRUJUQURBUUgvTUEwRwpDU3FHU0liM0RRRUJCUVVBQTRHQkFMb3NMcEhkdUZPWTMwd0tTMldRMzJSelJnaDBaV05sTFhXSGtRWW16VEhOCm9rd1lMeTB3R2ZJcXpEMW92TE1qRHVQTUMzTUJtUVBnOHpoZCtCWTJzZ1JoZ2RFQm1ZV1RpdzcxZVpMTG1JL2UKZFFidTF6NnJPWEpiOEVlZ3ViSk5rWVRjdXhzS0xpaklmSkRuSzJub3FQdDAzcHVKRXNCeG9zTjE0WFBFaElFTwotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0t"

    func testValidateSucceeds() throws {
        let certBytes = Data(base64Encoded: validCert)!
        let rootCertBytes = Data(base64Encoded: validRootCert)!

        XCTAssertNoThrow(try CertificateChain.validate(x5c: [certBytes], pemRootCertificateBytes: [rootCertBytes]))
    }
}
